# CNW QUERY
![Load Query](https://www.dropbox.com/s/wsyz1u5t83n4qaw/cnw_query_logo.jpeg?dl=1)

## Manual Book

> Author : Andy Utomo

> Company : Indoguna Utama

> Project Name : CNW Project

> Date : 2021-04-18

> Generated By : *Markdown*
---

# Deskripsi
CNW Query tools yang digunakan untuk mengeluarkan report dari SQL Query SAP Business One, berfungsi mirip seperti "*QUERY Manager SAP Business One*"

Terdiri dari 2 modul utama, Query Setup dan Query Manager. 

    Query Setup digunakan oleh admin untuk membuat query SAP Business One dan menyiapkan parameter parameter yang diperlukan
    
    Query Manager digunakan untuk menjalankan query yang disiapkan oleh admin
    



# QUERY SETUP

***Menu CNW QUERY -> Input Query***

![Input Query](https://www.dropbox.com/s/toc56xec49qbbjj/query_setup.jpeg?dl=1)

### Field

***Query Name*** : Nama Query 
> Contoh : "SAP : Business Partner List"


***Company*** : List Company yang akan dibuat Query nya
> Contoh : "My Company"


***Param Datefrom & Param Dateto*** : (Optional) Digunakan untuk parameter tanggal, bisa dipakai 2 2nya atau salah satu.
> Di SQL Query menggunakan format YYYYMMDD, *convert(varchar,docdate,112)*


***Param1, Param2, Param3, Param4*** : (Optional) Digunakan untuk parameter string


***Memo*** : (Optional) Digunakan untuk Menjelaskan pemakaian Query, parameter yang digunakan dan sebagainya.


***QueryResult*** : OUtput hasil dari menjalankan query. dalam bentuk text string


***Query*** : Inputan Query 

**Parameter yang bisa digunakan ada 6 parameter dan 1 builtin parameter **
* Datefrom : {{datefrom}}
* dateTo : {{dateto}}
* param1 : {{param1}}
* param2 : {{param2}}
* param3 : {{param3}}
* param4 : {{param4}}
* Company Code( BuiltIn) : {{company}}

**Contoh**
> Tanpa Parameter
```sql
SELECT top 40 '{{company}}' Company,
        CardCode,
        CardName
FROM OCRD
```



> atau Menjalankan procedure
```
EXECUTE IGU_ACT_LISTCOA '{{company}}'
```




> atau Menjalankan T-SQL 
```sql
declare @table table (  docnum int ,
                        docdate varchar(10))
insert into @table
SELECT TOP 20 DocNum , Docdate from OINV 
select  * from @table
```


> Dengan Parameter range tanggal
```sql
SELECT top 40 '{{company}}' Company,
        DocNum,
        CardCode,
        CardName ,
        DocTotal
FROM OINV A
where Canceled = 'N' 
and convert(varchar,A.DocDate,112) between '{{datefrom}}' and '{{dateto}}'
```



> Dengan Parameter range tanggal dan string
```sql
SELECT top 40 '{{company}}' Company,
        DocNum,
        CardCode,
        CardName ,
        DocTotal
FROM OINV A
where Canceled = 'N' 
and convert(varchar,A.DocDate,112) between '{{datefrom}}' and '{{dateto}}'
and A.CardCode + A.CardName like '%{{param1}}%'
```


>**Catatan** : Untuk tanggal menggunakan format YYYYMMDD, dan dalam query harus ditambahkan ***'***




# QUERY MANAGER

***Menu >> Load Query***

![Load Query](https://www.dropbox.com/s/xop5lekem9u1bzt/query_manager.jpeg?dl=1)


### Field

***Query Name*** : Nama Query yang sudah dibuat oleh admin

***Company*** : Nama Company untuk menjalankan query, bisa lebih dari 1 jika usernya di *Allow* otoritasnya.

***Param Datefrom, Param Dateto*** : Parameter tanggal

***Param1, Param2, Param3, Param4*** : Parameter String

***Result To*** : Format Output yang dibutuhkan

> Pilihan Format yang tersedia 
* Txt : Format Plain Text 
* Markdown : Format Markdown Text File
* CSV : Format CSV (, separator)
* HTML : Format Plain HTML 
* Excel : Format Excel (.xlsx)
* PDF : Format PDF




<!--stackedit_data:
eyJoaXN0b3J5IjpbNTQ4NzUyNzJdfQ==
-->